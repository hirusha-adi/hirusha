"use strict";(self.webpackChunkhirusha=self.webpackChunkhirusha||[]).push([[2189],{9355:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var i=s(5893),t=s(1151);const r={sidebar_position:2,title:"Post-installion setup",sidebar_label:"Post-install Setup",slug:"post-install-setup"},o=void 0,l={id:"windows/windows-ltsc-2021/post-install-setup",title:"Post-installion setup",description:"- do this to make windows ltsc 2021 daily drivable.",source:"@site/docs/windows/windows-ltsc-2021/post-install-setup.md",sourceDirName:"windows/windows-ltsc-2021",slug:"/windows/windows-ltsc-2021/post-install-setup",permalink:"/docs/windows/windows-ltsc-2021/post-install-setup",draft:!1,unlisted:!1,editUrl:"https://github.com/hirusha-adi/hirusha/tree/main/docs/windows/windows-ltsc-2021/post-install-setup.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,title:"Post-installion setup",sidebar_label:"Post-install Setup",slug:"post-install-setup"},sidebar:"windows",previous:{title:"Installation",permalink:"/docs/windows/windows-ltsc-2021/installation"}},d={},c=[{value:"Disable Telemtry",id:"disable-telemtry",level:2},{value:"Using O&amp;O ShutUp10",id:"using-oo-shutup10",level:3},{value:"Disabling <code>Allow Telemetry</code>",id:"disabling-allow-telemetry",level:3},{value:"Access Public Network Shares",id:"access-public-network-shares",level:2},{value:"Folders/Data (<code>0x80004005</code>)",id:"foldersdata-0x80004005",level:3},{value:"Printers (<code>0x0000011b</code>)",id:"printers-0x0000011b",level:3},{value:"Restore Microsoft Photos",id:"restore-microsoft-photos",level:2},{value:"OneDrive Problem",id:"onedrive-problem",level:2},{value:"Problem",id:"problem",level:3},{value:"Reason",id:"reason",level:3},{value:"Solution",id:"solution",level:3}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"do this to make windows ltsc 2021 daily drivable."}),"\n",(0,i.jsxs)(n.li,{children:["Make sure to check this out: ",(0,i.jsx)(n.a,{href:"https://rentry.co/LTSC",children:"Guide to install and optimize Windows 10 LTSC"})]}),"\n",(0,i.jsxs)(n.li,{children:["You might also wan't to take a look at this great project: ",(0,i.jsx)(n.a,{href:"https://github.com/Marctraider/LiveScript-LTSC-21H2",children:"LiveScript-LTSC-21H2 by Marctraider"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"disable-telemtry",children:"Disable Telemtry"}),"\n",(0,i.jsx)(n.h3,{id:"using-oo-shutup10",children:"Using O&O ShutUp10"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Luckily, no bloatware comes pre-installed with this version of windows, but, there's still some telemetry left."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Download and run ",(0,i.jsx)(n.a,{href:"https://www.oo-software.com/en/shutup10",children:"O&O ShutUp10"})," to disable telemetry."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://www.naut.ca/blog/content/images/2019/07/sidebysideshutup10v2.png",alt:"a1"})}),"\n",(0,i.jsxs)(n.h3,{id:"disabling-allow-telemetry",children:["Disabling ",(0,i.jsx)(n.code,{children:"Allow Telemetry"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"In local group policy editor"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://i.imgur.com/CD7wfNB.png",alt:"a2"})}),"\n",(0,i.jsx)(n.h2,{id:"access-public-network-shares",children:"Access Public Network Shares"}),"\n",(0,i.jsxs)(n.h3,{id:"foldersdata-0x80004005",children:["Folders/Data (",(0,i.jsx)(n.code,{children:"0x80004005"}),")"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["If you are the kind of person that has your small local samba share setup at your house with no authentication (guest login allowed), you will run into this error: ",(0,i.jsx)(n.code,{children:"0x80004005"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://i.stack.imgur.com/PCJ3z.png",alt:"i1"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:'Microsoft posts the official "workaround" which is enabling the "AllowInsecureGuestAuth" group policy'}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://i.stack.imgur.com/Arp4t.png",alt:"i2"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"And it works"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://i.stack.imgur.com/JZyO6.png",alt:"i3"})}),"\n",(0,i.jsxs)(n.h3,{id:"printers-0x0000011b",children:["Printers (",(0,i.jsx)(n.code,{children:"0x0000011b"}),")"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["But, when you try to access a printer, you will get this error: ",(0,i.jsx)(n.code,{children:"0x0000011b"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://i.stack.imgur.com/2S6se.png",alt:"i4"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["The posted official workaround is incomplete and printing doesn't fully respect this group policy configuration because as a fix for ",(0,i.jsx)(n.a,{href:"https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1678",children:"CVE-2021-1678"})," Microsoft increased the printer spooler protection but they forgot to let printing work for people who don't bother too much with proper encryption and authentication which ",(0,i.jsx)(n.code,{children:"AllowInsecureGuestAuth"})," disables"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["To fix it, add or modify a Printer Spooler registry setting called ",(0,i.jsx)(n.code,{children:"RpcAuthnLevelPrivacyEnabled"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'[HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Print]\r\n"RpcAuthnLevelPrivacyEnabled"=dword:00000000\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"or, run this powershell command:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Set-ItemProperty -Path 'HKLM:\\System\\CurrentControlSet\\Control\\Print' -Name 'RpcAuthnLevelPrivacyEnabled' -Value 0\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Restarting the Printer Spooler service is enough to apply the fix"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://i.stack.imgur.com/TyYQn.png",alt:"i5"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Looking back at both of these error, if they still won't work, try this instead:"}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Set ",(0,i.jsx)(n.code,{children:"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters\\AllowInsecureGuestAuth"})," to 1"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"You can also run the command below:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Set-ItemProperty -Path 'HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters' -Name 'AllowInsecureGuestAuth' -Value 1\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["You may also have to enable/run 2 system services at ",(0,i.jsx)(n.code,{children:"services.msc"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Function Discovery Provider Host"}),"\n",(0,i.jsx)(n.li,{children:"Function Discovery Resource Publication"}),"\n",(0,i.jsx)(n.li,{children:"both of which got disabled by default, and is for network sharing/browsing."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"restore-microsoft-photos",children:"Restore Microsoft Photos"}),"\n",(0,i.jsxs)(n.p,{children:["The only good alternative to Microsoft Photos is ",(0,i.jsx)(n.a,{href:"https://github.com/d2phap/ImageGlass",children:"ImageGlass"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://raw.githubusercontent.com/ImageGlass/releases/main/screenshots/v9.0/9.0_b1.webp",alt:"a3"})}),"\n",(0,i.jsx)(n.h2,{id:"onedrive-problem",children:"OneDrive Problem"}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Source: ",(0,i.jsx)(n.a,{href:"https://rentry.org/od_problem",children:"https://rentry.org/od_problem"})]})}),"\n",(0,i.jsx)(n.h3,{id:"problem",children:"Problem"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The personal Onedrive icon inside navigation panel does not work. The property page shows blank. By using ",(0,i.jsx)(n.code,{children:"Win+R"})," to run ",(0,i.jsx)(n.code,{children:"shell:::{018D5C66-4533-4307-9B53-224DE2ED1FE6}"}),", you should see the OneDrive folder opened but it\u2019s not."]}),"\n",(0,i.jsx)(n.li,{children:"However, the business account will work completely fine and also other file sync application such as iCloud and nextCloud."}),"\n",(0,i.jsx)(n.li,{children:"This happens to all latest OneDrive version (32/64 bit) installed per users or for all users under Windows 10 LTSC 2021."}),"\n",(0,i.jsx)(n.li,{children:"by the way, the default version bundled with Windows 10 is 32 bit regardless of the Windows version."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"reason",children:"Reason"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["When you setup the personal OneDrive account, the client should register the icon in navigation panel pointing to a CLSID (Basically the GUID of the folder registered as Known Folders) ",(0,i.jsx)(n.code,{children:"{A52BBA46-E9E1-435f-B3D9-28DAA648C0F6}"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"This is the CLSID of the OneDrive folder which should be registered meanwhile, and it contains the path to the OneDrive folder."}),"\n",(0,i.jsx)(n.li,{children:"BUT the client did not do so in LTSC"}),"\n",(0,i.jsx)(n.li,{children:"Therefore, when you start the explorer, the icon itself was displayed, but it points to a ID which doesn\u2019t exist."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"solution",children:"Solution"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Copy the following content into a text file, save it as ",(0,i.jsx)(n.code,{children:"ANYNAME.reg"}),", double click on it and let the regedit import it. Restart the file explorer and all set!"]}),"\n",(0,i.jsxs)(n.li,{children:["This only applies if your OneDrive folder is at the default location. e.g. ",(0,i.jsx)(n.code,{children:"C:\\User\\username\\OneDrive"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["If it\u2019s not but still under your user folder e.g. ",(0,i.jsx)(n.code,{children:"C:\\User\\username\\ExampleFolder"}),", you need to change the value of ",(0,i.jsx)(n.code,{children:"RelativePath"})," to ",(0,i.jsx)(n.code,{children:"ExampleFolder"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["If it\u2019s not under your user folder, e.g. ",(0,i.jsx)(n.code,{children:"E:\\OneDrive"}),", you need to remove the line ",(0,i.jsx)(n.code,{children:'"ParentFolder"="{5E6C858F-0E22-4760-9AFE-EA3317B67173}"'}),", and change the value of RelativePath to the absolute path such as ",(0,i.jsx)(n.code,{children:'"RelativePath"="E:\\OneDrive"'}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'Windows Registry Editor Version 5.00\r\n\r\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FolderDescriptions\\{5E6C858F-0E22-4760-9AFE-EA3317B67173}]\r\n"Category"=dword:00000002\r\n"Name"="Profile"\r\n\r\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FolderDescriptions\\{A52BBA46-E9E1-435f-B3D9-28DAA648C0F6}]\r\n"Attributes"=dword:00000001\r\n"Category"=dword:00000004\r\n"DefinitionFlags"=dword:00000040\r\n"Icon"=hex(2):25,00,53,00,79,00,73,00,74,00,65,00,6d,00,52,00,6f,00,6f,00,74,  00,25,00,5c,00,73,00,79,00,73,00,74,00,65,00,6d,00,33,00,32,00,5c,00,69,00,  6d,00,61,00,67,00,65,00,72,00,65,00,73,00,2e,00,64,00,6c,00,6c,00,2c,00,2d,  00,31,00,30,00,34,00,30,00,00,00\r\n"LocalizedName"=hex(2):40,00,25,00,53,00,79,00,73,00,74,00,65,00,6d,00,52,00,  6f,00,6f,00,74,00,25,00,5c,00,53,00,79,00,73,00,74,00,65,00,6d,00,33,00,32,  00,5c,00,53,00,65,00,74,00,74,00,69,00,6e,00,67,00,53,00,79,00,6e,00,63,00,  43,00,6f,00,72,00,65,00,2e,00,64,00,6c,00,6c,00,2c,00,2d,00,31,00,30,00,32,  00,34,00,00,00\r\n"LocalRedirectOnly"=dword:00000001\r\n"Name"="OneDrive"\r\n"ParentFolder"="{5E6C858F-0E22-4760-9AFE-EA3317B67173}"\r\n"ParsingName"="shell:::{018D5C66-4533-4307-9B53-224DE2ED1FE6}"\r\n"RelativePath"="OneDrive"\n'})})]})}function h(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},1151:(e,n,s)=>{s.d(n,{Z:()=>l,a:()=>o});var i=s(7294);const t={},r=i.createContext(t);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);